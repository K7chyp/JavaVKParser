# VK API Client

–ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Java –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å VK API —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ REST –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã.

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- üìä **–°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∏—Ö –¥—Ä—É–∑—å—è–º, –≥—Ä—É–ø–ø–∞–º –∏ –ø–æ—Å—Ç–∞–º
- üîç **–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –∏–∑ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
- üìà **–†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Stream API
- üìÅ **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** –≤ JSON –∏ CSV —Ñ–æ—Ä–º–∞—Ç—ã
- üìù **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ñ–∞–π–ª
- ‚öôÔ∏è **–ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** —á–µ—Ä–µ–∑ properties-—Ñ–∞–π–ª
- üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã** –ø—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö VK API

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã VK API
- `users.search` - –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥–æ—Ä–æ–¥—É
- `friends.get` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π
- `groups.get` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≥—Ä—É–ø–ø
- `wall.get` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Å–æ —Å—Ç–µ–Ω—ã

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Java 11** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **Maven** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ —Å–±–æ—Ä–∫–∞
- **Gson** - —Ä–∞–±–æ—Ç–∞ —Å JSON
- **SLF4J + Logback** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Java HTTP Client** - HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ VK API
- **Stream API** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª

```properties
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ VK API
vk.api.token=YOUR_VK_API_TOKEN_HERE
vk.api.version=5.199

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∏—Å–∫–∞
search.city.id=1
search.city.name=–ú–æ—Å–∫–≤–∞

# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (true - —Ç–µ—Å—Ç–æ–≤—ã–π, false - –ø–æ–ª–Ω—ã–π)
test.mode=true
test.users.count=5
full.users.count=50
search.users.per_request=100

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–¥–µ—Ä–∂–µ–∫ (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)
request.delay.base=500
request.delay.retry.multiplier=2
request.max.retries=3

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
statistics.friends.sample=3
statistics.posts.count=5

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logging.level=INFO
logging.file=logs/vk-api-client.log

# –≠–∫—Å–ø–æ—Ä—Ç
export.json.enabled=true
export.csv.enabled=false
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/main/java/
‚îú‚îÄ‚îÄ dto/                    
‚îÇ   ‚îú‚îÄ‚îÄ UserSearchResponse.java
‚îÇ   ‚îú‚îÄ‚îÄ FriendsResponse.java
‚îÇ   ‚îú‚îÄ‚îÄ GroupsResponse.java
‚îÇ   ‚îî‚îÄ‚îÄ WallResponse.java
‚îú‚îÄ‚îÄ service/               
‚îÇ   ‚îú‚îÄ‚îÄ VkApiService.java
‚îÇ   ‚îú‚îÄ‚îÄ StatisticsService.java
‚îÇ   ‚îú‚îÄ‚îÄ ExportService.java
‚îÇ   ‚îî‚îÄ‚îÄ VkApiException.java
‚îú‚îÄ‚îÄ util/                  
‚îÇ   ‚îî‚îÄ‚îÄ ConfigReader.java
‚îî‚îÄ‚îÄ Main.java             

src/main/resources/
‚îú‚îÄ‚îÄ config.properties      
‚îú‚îÄ‚îÄ logback.xml           
‚îî‚îÄ‚îÄ config.properties.example 
```

## üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

### JSON —ç–∫—Å–ø–æ—Ä—Ç
- **–§–æ—Ä–º–∞—Ç**: `statistics_[userId]_[timestamp].json`
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**: –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- **–ü—Ä–∏–º–µ—Ä –∏–º–µ–Ω–∏**: `statistics_12345_20241110110309.json`

### CSV —ç–∫—Å–ø–æ—Ä—Ç 
- **–î—Ä—É–∑—å—è**: `friends_[userId]_[timestamp].csv`
- **–ì—Ä—É–ø–ø—ã**: `groups_[userId]_[timestamp].csv`
- **–ö–æ–ª–æ–Ω–∫–∏**:
  - –î—Ä—É–∑—å—è: ID, FirstName, LastName, City, FriendsCount
  - –ì—Ä—É–ø–ø—ã: ID, Name, ScreenName, MembersCount, Type

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª `logs/vk-api-client.log` –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```
[2024-11-10 11:03:09] [INFO] [VkApiService] - GET https://api.vk.com/method/users.search?... (235ms, 4521 chars)
[2024-11-10 11:03:09] [ERROR] [VkApiService] - VK API Error [5]: User authorization failed
[2024-11-10 11:03:09] [WARN] [Main] - –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥—Ä—É–∑–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 12345
```


## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏ VK API:

| –ö–æ–¥ –æ—à–∏–±–∫–∏ | –û–ø–∏—Å–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
|------------|----------|---------------------|
| **Error 5** | –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
| **Error 6** | –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ | –ü–æ–≤—Ç–æ—Ä —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π |
| **Error 9** | Flood control | –î–ª–∏—Ç–µ–ª—å–Ω–∞—è –ø–∞—É–∑–∞ –∏ –ø–æ–≤—Ç–æ—Ä |
| **Error 100** | –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ |

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- **–ë–∞–∑–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞**: 500 –º—Å –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff**: –£–¥–≤–æ–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ
- **–ú–∞–∫—Å–∏–º—É–º –ø–æ–≤—Ç–æ—Ä–æ–≤**: 3 —Ä–∞–∑–∞ –¥–ª—è –æ—à–∏–±–æ–∫ 6 –∏ 9

## üéØ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
```properties
test.mode=true
test.users.count=5
```
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫, –º–∞–ª–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—Ç–ª–∞–¥–∫–∞, –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

### –ü–æ–ª–Ω—ã–π —Ä–µ–∂–∏–º
```properties
test.mode=false
full.users.count=5000
```
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –±–æ–ª—å—à–∞—è –≤—ã–±–æ—Ä–∫–∞
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –§–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫, —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö

---

## PS
–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ –ø–æ–∑–∞–ø—É—Å–∫–∞—Ç—å –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ –∏–∑ - –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å, –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞—é —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —É –º–µ–Ω—è –ø–æ–ª—É—á–∏–ª–∏—Å—å –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ, –∫–æ–≥–¥–∞ —è –ø—Ä–æ–ø–æ–±–æ–≤–∞–ª (–∏–∑ –∏–Ω—Ç–µ—Ä–µ—Å–∞) –¥–ª—è –ú–æ—Å–∫–≤—ã
